# 영화관

## 1. 도메인 언어사전

### Role
| 한글       | 영어       |
|----------|----------|
| 등록하다     | regist   |
| 조회하다     | search   |
| 예매하다     | reserve  |
| 취소하다     | cancel   |
| 할인을 적용하다 | apply    |
| 상영계획 세우다 | schedule |
| 결제하다     | pay      |
| 가격       | price    |
| 순서       | order    |

### Entity & Value
#### - Entity : 고유의 식별자를 갖는다.
#### - Value : 개념적으로 완전한 하나를 표현할 때 사용
| 엔티티                     | 밸류      | 영어         |
|-------------------------|---------|------------|
| 영화(MOVIE)               | id      | id         |
|                         | 영화명     | title      |
|                         | 상영시간    | playtime   |
|                         | 설명      | description |
| 상영(SCREENING)           | id      | id         |
|                         | 가격      | price      |
|                         | 좌석수     | seatLimit  |
|                         | 상영시작 시간 | startAt    |
|                         | 상영종료 시간 | endAt      |
| 예매(TICKETING)           | id      | id         |
|                         | 예매장수    | ticketCount |
|                         | 예매상태    | status     |
| 결제(PAYMENT)             | id      | id         |
|                         | 결제금액    | paidPrice  |
|                         | 환불금액    | refundPrice |
|                         | 결제상태    | status     |
| 기간 할인조건(PERIOD_DISCOUNT) | id      | id         |
|                         | 할인시작 시간 | startAt    |
|                         | 할인종료 시간 | endAt      |
| 순서 할인조건(ORDER_DISCOUNT) | id      | id         |
|                         | 할인순번    | order      |
|                         | 할인날짜    | date       |
| 할인정책(DISCOUNT_POLICY)   | id      | id         |
|                         | 정률/정액   | type       |
|                         | 정률할인비율  | rate       |
|                         | 정액할인가   | price      |


### 애그리거트
#### - 애그리거트 : 연관된 엔티티와 밸류 객체를 하나로 묶은것
#### - 애그리거트 루트 : 애그리거트 상태를 관리하는 주체
1. 도메인 규칙 제공  
2. 각 애그리거트가 제공해야 할 도메인 기능을 구현한다.  
3. 각 애그리거트에 속한 객체의 일관성이 깨지지 않도록 구현해야한다.

| 루트애그리거트       | 밸류           | 영어          |
|---------------|--------------|-------------|
| 영화(MOVIE)     |              |             |
|               | 영화명          | title       |
|               | 상영시간         | playtime    |
|               | 설명           | description |
| 상영(SCREENING) |              |             |
|               | **영화Entity** | movie       |
|               | 가격           | price       |
|               | 좌석수          | seatLimit   |
|               | 상영시작 시간      | startAt     |
|               | 상영종료 시간      | endAt       |
| 예매(TICKETING) |              |             |
|               | **영화Entity**     | movie       |
|               | **상영Entity**     | screening   |
|               | 예매장수         | ticketCount |
|               | 예매상태         | status      |
| 결제(PAYMENT)   |              |             |
|               | **예매Entity**     | ticketing |
|               | **할인Entity**     | discount    |
|               | 결제금액         | paidPrice   |
|               | 환불금액         | refundPrice |
|               | 결제상태         | status      |


### 도메인 분리
| 도메인          |                |              | 설명  | 기능                | 협력도메인            | 행위주체    |
|--------------|--------------|-------------|-----|-------------------|------------------|---------|
| 영화(MOVIE)    |              |            |     | 영화를 등록한다.         |                  | 관리자     |
| 상영(SCREENING) |              |            |     | 상영시간을 등록한다.       | **상영**           | 관리자     |
| 예매(TICKETING) |              |            |     | 영화티켓을 예매한다.       | **영화, 상영** | 유저,관리자  |
| 결제(PAYMENT)  |              |            |     | 영화티켓을 결제한다.       | **예매, 할인**       | 유저, 관리자 |
| 할인(DISCOUNT) |              |            |     | 영화티켓결제시 할인을 적용한다. |                  |      |



### 도메인 상세
#### 영화
1. 영화 등록시 영화 제목, 영화 상영시간은 필수값이다. 
2. 영화 등록후, 상영하지 않을 수 있다.
3. 영화 등록은 관리자만 등록할 수 있다.

#### 상영(영화시간표)
1. 영화관은 1개이다. 따라서, 동시간대에 영화를 상영 시간표에 등록할 수 있다.
2. 상영시간표 시작/종료 시간은 필수 값이다. 
3. 상영시간표 등록시, 가격은 필수 값이다.
4. 상영관의 좌석 수는 제한이 있다.
5. 상영 시간표를 등록하기 위해서는 영화 등록이 우선시 되어야 한다.
6. 당일 상영 시간표를 등록할 수 없다.
7. 상영 시간표는 오늘 기준 다음날(자정 이후) 부터 등록할 수 있다.

#### 예매
1. 상영 시간표에 등록된 영화만 예매를 진행할 수 있다.
2. 상영 시간표 10분전까지만 영화를 예매할 수 있다.
3. 영화관 자리가 없을시, 예매를 할 수 없다.
4. 예매시, 예매 티켓 수는 필수 값이다.

#### 결제
1. 결제수단은 카드와 무료 예매권이 있다.
2. 영화가 시작시간 10분전 이후에는 카드결제를 취소 할 수 없다.
3. 무료 예매권은 취소 불가하다.
4. 카드결제시 할부는 불가능 하다.
5. 결제취소시, 할인금액 을 제외한 실 결제금액만 환불한다.

#### 할인
1. 할인조건에 부합하면, 영화가격을 할인해준다.
2. 할인조건에는 2가지가 존재한다.
   1. 순서조건 : 특정일에 영화 순번을 지정하여 할인을 적용시킨다.
    > 2023 4월 17일 3번째 영화는 할인을 한다.  
      순번은 여러개가 될 수 있다. (3번째, 6번째)
   2. 기간조건 : 특정 기간 동안 할인을 적용시킨다.
    > 2023 4월 17일 ~ 4월 20일 까지 영화할인 가능하다.
3. 순서조건과 기간조건은 양립할 수 있으며, 할인율이 가장 큰 할인을 적용시켜 준다.
4. 가격할인정책은 정률/정액 할인이 있다.
5. 정률/정액 할인의 경우, 영화 가격의 50% 이상을 넘을 수 없다.
